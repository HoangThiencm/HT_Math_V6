<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HT_MATH_WEB - Chuy·ªÉn ƒë·ªïi th√¥ng minh</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üìÑ</text></svg>">
    
    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    
    <!-- Libs -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.6/dist/purify.min.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- PH·∫¶N 1: M√ÄN H√åNH ƒêƒÇNG NH·∫¨P (Hi·ªÉn th·ªã m·∫∑c ƒë·ªãnh) -->
        <div id="authSection" class="auth-overlay">
            <div class="auth-box glass-effect">
                <div class="auth-brand">
                    <div class="brand-logo"><i class="fa-solid fa-layer-group"></i></div>
                    <h1>HT Math Web</h1>
                    <p>C√¥ng c·ª• chuy·ªÉn ƒë·ªïi To√°n h·ªçc chuy√™n nghi·ªáp</p>
                </div>

                <!-- Form ƒêƒÉng Nh·∫≠p -->
                <div id="loginForm" class="auth-form-content">
                    <div class="input-group">
                        <i class="fa-regular fa-envelope input-icon"></i>
                        <input type="email" id="loginEmail" placeholder="Email ƒëƒÉng nh·∫≠p" required>
                    </div>
                    <div class="input-group">
                        <i class="fa-solid fa-lock input-icon"></i>
                        <input type="password" id="loginPassword" placeholder="M·∫≠t kh·∫©u" required>
                    </div>
                    <button class="btn btn-primary btn-block" onclick="handleLogin()">
                        ƒêƒÉng nh·∫≠p <i class="fa-solid fa-arrow-right"></i>
                    </button>
                    <!-- TUY·ªÜT ƒê·ªêI KH√îNG C√ì LINK ADMIN ·ªû ƒê√ÇY -->
                    <p class="auth-footer">
                        Ch∆∞a c√≥ t√†i kho·∫£n? <a href="#" onclick="showRegister()">ƒêƒÉng k√Ω ngay</a>
                    </p>
                </div>

                <!-- Form ƒêƒÉng K√Ω -->
                <div id="registerForm" class="auth-form-content" style="display: none;">
                    <div class="input-group">
                        <i class="fa-regular fa-envelope input-icon"></i>
                        <input type="email" id="registerEmail" placeholder="Email c·ªßa b·∫°n" required>
                    </div>
                    <div class="input-group">
                        <i class="fa-solid fa-lock input-icon"></i>
                        <input type="password" id="registerPassword" placeholder="T·∫°o m·∫≠t kh·∫©u" required>
                    </div>
                    <button class="btn btn-success btn-block" onclick="handleRegister()">
                        ƒêƒÉng k√Ω t√†i kho·∫£n
                    </button>
                    <p class="auth-footer">ƒê√£ c√≥ t√†i kho·∫£n? <a href="#" onclick="showLogin()">ƒêƒÉng nh·∫≠p</a></p>
                </div>
            </div>
            <!-- Hi·ªáu ·ª©ng n·ªÅn -->
            <div class="bg-blob blob-1"></div>
            <div class="bg-blob blob-2"></div>
        </div>

        <!-- PH·∫¶N 2: ·ª®NG D·ª§NG CH√çNH (·∫®n m·∫∑c ƒë·ªãnh) -->
        <div id="mainApp" class="dashboard fade-in" style="display: none;">
            <!-- Sidebar (Tr√°i) -->
            <aside class="sidebar glass-effect">
                <div class="sidebar-header">
                    <div class="logo-text"><i class="fa-solid fa-layer-group"></i> HT Math</div>
                    <span class="badge-pro">V6.0</span>
                </div>

                <div class="sidebar-content">
                    <div class="section-title">ƒê·∫¶U V√ÄO</div>
                    
                    <!-- Upload -->
                    <div class="upload-widget">
                        <div class="drop-zone" onclick="document.getElementById('fileInput').click()">
                            <div class="drop-icon-wrapper"><i class="fa-solid fa-cloud-arrow-up"></i></div>
                            <h3>T·∫£i t√†i li·ªáu</h3>
                            <p>PDF, PNG, JPG</p>
                            <input type="file" id="fileInput" accept=".pdf,.png,.jpg,.jpeg,.bmp" style="display: none;">
                        </div>
                        <div class="file-status">
                            <input type="text" id="filePath" placeholder="Ch∆∞a ch·ªçn file..." readonly>
                        </div>
                        <div class="quick-actions-grid">
                            <button class="btn-icon" onclick="handlePasteImage()" title="D√°n ·∫£nh (Ctrl+V)"><i class="fa-regular fa-clipboard"></i></button>
                            <button class="btn-icon" onclick="handleScreenshot()" title="Ch·ª•p m√†n h√¨nh"><i class="fa-solid fa-camera"></i></button>
                            <input type="file" id="screenshotInput" accept="image/*" capture="environment" style="display: none;">
                        </div>
                    </div>

                    <div class="divider"></div>

                    <div class="section-title">C·∫§U H√åNH</div>
                    <div class="settings-group">
                        <label>AI Model</label>
                        <select id="modelSelect" class="custom-select">
                            <option value="gemini-3-flash-preview">Gemini 3.0 Flash</option>
                            <option value="gemini-2.5-flash">Gemini 2.5 Flash</option>
                        </select>
                    </div>

                    <div class="settings-group">
                        <label>Ch·∫ø ƒë·ªô xu·∫•t</label>
                        <div class="toggle-group">
                            <label class="toggle-option">
                                <input type="radio" name="mode" value="latex" checked>
                                <span class="toggle-btn">LaTeX</span>
                            </label>
                            <label class="toggle-option">
                                <input type="radio" name="mode" value="text_only">
                                <span class="toggle-btn">Text</span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="settings-group">
                         <label class="checkbox-wrapper">
                            <input type="checkbox" id="keepImages" checked>
                            <span class="checkmark"></span>
                            Gi·ªØ h√¨nh v·∫Ω (Word)
                        </label>
                    </div>
                </div>

                <div class="sidebar-footer">
                    <button class="btn btn-primary btn-block btn-lg glow-effect" onclick="handleConvert()">
                        <i class="fa-solid fa-bolt"></i> Chuy·ªÉn ƒë·ªïi
                    </button>
                </div>
            </aside>

            <!-- Workspace (Ph·∫£i) -->
            <main class="main-workspace">
                <header class="workspace-header">
                    <div class="user-welcome">
                        <div class="avatar"><i class="fa-solid fa-user"></i></div>
                        <div class="user-meta">
                            <span class="status-dot"></span>
                            <span id="keyStatus">S·∫µn s√†ng</span>
                        </div>
                    </div>
                    <div class="header-actions">
                        <button class="btn-ghost" onclick="showConfig()" title="C√†i ƒë·∫∑t API"><i class="fa-solid fa-gear"></i></button>
                        <button class="btn-ghost text-danger" onclick="handleLogout()" title="ƒêƒÉng xu·∫•t"><i class="fa-solid fa-right-from-bracket"></i></button>
                    </div>
                </header>

                <div class="editor-container glass-effect">
                    <div class="editor-toolbar">
                        <div class="toolbar-left">
                            <span class="tab active"><i class="fa-solid fa-code"></i> K·∫øt qu·∫£</span>
                        </div>
                        <div class="toolbar-right">
                             <div class="progress-indicator">
                                <div id="progressBar" class="progress-line">
                                    <div id="progressFill" class="progress-fill"></div>
                                </div>
                                <span id="progressText">0%</span>
                            </div>
                            <span id="statusLabel" class="status-text">Ready</span>
                        </div>
                    </div>
                    
                    <div class="editor-body">
                        <textarea id="resultText" class="code-editor" placeholder="// K·∫øt qu·∫£ chuy·ªÉn ƒë·ªïi s·∫Ω hi·ªÉn th·ªã t·∫°i ƒë√¢y..."></textarea>
                    </div>

                    <div class="editor-footer">
                        <button class="btn-secondary" onclick="handleReset()">
                            <i class="fa-solid fa-rotate-right"></i> Reset
                        </button>
                        <div class="export-group">
                            <button class="btn-secondary" onclick="handleCopyText()"><i class="fa-regular fa-copy"></i> Copy</button>
                            <button class="btn-outline" onclick="handleExportWord()">
                                <i class="fa-solid fa-file-word"></i> Word
                            </button>
                            <button class="btn-outline" onclick="handleExportWordLatex()">
                                <i class="fa-solid fa-file-code"></i> LaTeX
                            </button>
                        </div>
                    </div>
                </div>
            </main>
        </div>

        <!-- Config Modal -->
        <div id="configModal" class="modal-backdrop">
            <div class="modal-card">
                <div class="modal-header">
                    <h3>C·∫•u h√¨nh h·ªá th·ªëng</h3>
                    <button class="close-btn" onclick="closeConfig()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>API Endpoint (Backend URL)</label>
                        <input type="text" id="apiEndpoint" class="form-input" placeholder="https://your-app.hf.space">
                    </div>
                    <div class="form-group">
                        <label>Lu·ªìng x·ª≠ l√Ω (Threads)</label>
                        <select id="threadCount" class="form-select">
                            <option value="1">1 Thread</option>
                            <option value="3" selected>3 Threads</option>
                            <option value="5">5 Threads</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn-secondary" onclick="closeConfig()">H·ªßy</button>
                    <button class="btn-primary" onclick="saveConfig()">L∆∞u thay ƒë·ªïi</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Logic -->
    <script src="app.js"></script>
</body>
</html>
